import{d as C,q as k,o as r,e as o,a as t,g as $,f as x,I as _,F as I,j as E,t as j,h as N,b as B}from"./app-CqbgnAp8.js";const M={class:"relative w-full h-full"},S=["src","alt"],z={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity duration-200 rounded-lg"},V={class:"bg-white bg-opacity-90 p-4 rounded-lg shadow-lg"},A={class:"flex flex-col gap-2"},L={class:"text-black text-sm font-medium"},U={key:1,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},D={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},W={__name:"GalleryImage",props:{section:{type:String,required:!0},imageIndex:{type:Number,required:!0},currentImage:{type:Object,default:null},placeholderImage:{type:String,default:"/images/placeholder.svg"},isEditing:{type:Boolean,default:!1}},emits:["image-updated"],setup(i,{emit:h}){const a=i,m=h,u=C(!1),c=C(!1),y=s=>s?s.startsWith("/storage/")?s:s.startsWith("storage/")?"/"+s:s.startsWith("http")||s.startsWith("/")?s:`/storage/${s}`:"",v=k(()=>a.currentImage?a.currentImage.url||y(a.currentImage.path):a.placeholderImage),e=async s=>{const d=s.target.files[0];if(d)try{u.value=!0;const f=new FormData;f.append("image",d),f.append("section",a.section);let b,w="add";a.currentImage&&a.currentImage.name&&a.currentImage.name.startsWith("image_")?(b=a.currentImage.name,w="replace"):(b=`image_${a.imageIndex+1}`,w="add"),console.log("Subiendo imagen:",{imageName:b,action:w,section:a.section}),f.append("name",b);const p=await E.post("/api/media/upload",f,{headers:{"Content-Type":"multipart/form-data"}});p.data.success&&(console.log("Imagen subida exitosamente:",p.data),m("image-updated",{section:a.section,imageIndex:a.imageIndex,image:{id:p.data.data.id,path:p.data.data.path,url:p.data.data.url,name:p.data.data.name,type:"image"},action:w}))}catch(f){console.error("Error al actualizar imagen:",f)}finally{u.value=!1}},l=()=>{c.value=!0},g=()=>{c.value=!1},n=async()=>{if(!a.currentImage||!a.currentImage.id){console.error("No hay imagen para eliminar");return}try{const s=await E.delete(`/api/media/${a.currentImage.id}`);s.data.success?(console.log("Imagen eliminada exitosamente"),m("image-updated",{section:a.section,imageIndex:a.imageIndex,action:"delete",deletedImageId:a.currentImage.id}),g()):console.error("Error al eliminar la imagen:",s.data.message)}catch(s){console.error("Error al eliminar la imagen:",s)}};return(s,d)=>(r(),o(I,null,[t("div",M,[t("img",{src:v.value,alt:`${i.section} - Imagen ${i.imageIndex+1}`,class:"w-full h-full object-cover rounded-lg"},null,8,S),i.isEditing?(r(),o("div",z,[t("div",V,[t("div",A,[t("label",L,[d[0]||(d[0]=$(" Cambiar imagen: ")),t("input",{type:"file",onChange:e,accept:"image/*",class:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,32)]),i.currentImage&&i.currentImage.id?(r(),o("button",{key:0,onClick:l,class:"mt-2 px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded text-sm font-medium transition-colors"},d[1]||(d[1]=[t("div",{class:"flex items-center gap-1"},[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})]),$(" Eliminar ")],-1)]))):x("",!0)])])])):x("",!0),u.value?(r(),o("div",U,d[2]||(d[2]=[_('<div class="bg-white p-4 rounded-lg shadow-lg flex items-center gap-2"><svg class="animate-spin h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg><span class="text-black">Subiendo...</span></div>',1)]))):x("",!0)]),c.value?(r(),o("div",D,[t("div",{class:"bg-white p-6 rounded-lg shadow-xl max-w-md w-full mx-4"},[t("div",{class:"text-center"},[d[3]||(d[3]=_('<div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4"><svg class="h-6 w-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg></div><h3 class="text-lg font-medium text-gray-900 mb-2"> Confirmar eliminación </h3><p class="text-sm text-gray-500 mb-6"> ¿Estás seguro de que quieres eliminar esta imagen? Esta acción no se puede deshacer. </p>',3)),t("div",{class:"flex gap-3 justify-center"},[t("button",{onClick:g,class:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-md text-sm font-medium transition-colors"}," Cancelar "),t("button",{onClick:n,class:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md text-sm font-medium transition-colors"}," Eliminar ")])])])])):x("",!0)],64))}},G={class:"py-16 px-12"},H={class:"max-w-6xl mx-auto"},q={class:"text-2xl font-bold text-white mb-6 text-center"},F={key:0,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},T={key:1,class:"text-center py-8"},O={key:2,class:"flex justify-center mt-6"},ee={__name:"Gallery",props:{images:{type:Array,default:()=>[]},section:{type:String,default:"gallery"},title:{type:String,default:"Galería Principal"},isEditing:{type:Boolean,default:!1}},emits:["images-updated"],setup(i,{emit:h}){const a=i,m=h,u=e=>e?e.startsWith("/storage/")?e:e.startsWith("storage/")?"/"+e:e.startsWith("http")||e.startsWith("/")?e:`/storage/${e}`:"",c=k(()=>a.images.map(e=>({...e,path:e.url||u(e.path)}))),y=e=>{console.log("Imagen de galería actualizada:",e),m("images-updated",e)},v=()=>{const e=document.createElement("input");e.type="file",e.accept="image/*",e.style.display="none",e.onchange=l=>{const g=l.target.files[0];if(g){let n=1;const s=c.value.map(d=>d.name);for(;s.includes(`image_${n}`);)n++;console.log("Agregando nueva imagen:",{nextIndex:n,section:a.section}),m("images-updated",{section:a.section,imageIndex:n-1,file:g,type:"image",action:"add"})}document.body.removeChild(e)},document.body.appendChild(e),e.click()};return(e,l)=>(r(),o("div",G,[t("div",H,[t("h2",q,j(i.title||"Galería de Imágenes"),1),c.value&&c.value.length>0?(r(),o("div",F,[(r(!0),o(I,null,N(c.value,(g,n)=>(r(),o("div",{key:n,class:"h-32"},[B(W,{section:i.section,"image-index":n,"current-image":g,"is-editing":i.isEditing,onImageUpdated:y},null,8,["section","image-index","current-image","is-editing"])]))),128))])):(r(),o("div",T,l[0]||(l[0]=[t("div",{class:"text-gray-400 mb-4"},[t("svg",{class:"mx-auto h-12 w-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})])],-1),t("p",{class:"text-gray-500"},"No hay imágenes en esta galería",-1)]))),i.isEditing?(r(),o("div",O,[t("button",{onClick:v,class:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-md transition-colors duration-200 flex items-center space-x-2"},l[1]||(l[1]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),t("span",null,"Agregar imagen",-1)]))])):x("",!0)])]))}},P={class:"py-16 px-12"},J={class:"max-w-6xl mx-auto"},K={class:"text-2xl font-bold text-white mb-6 text-center"},Q={key:0,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},R={key:1,class:"text-center py-8"},X={key:2,class:"flex justify-center mt-6"},te={__name:"Gallery2",props:{images:{type:Array,default:()=>[]},section:{type:String,default:"gallery2"},title:{type:String,default:"Galería Secundaria"},isEditing:{type:Boolean,default:!1}},emits:["images-updated"],setup(i,{emit:h}){const a=i,m=h,u=e=>e?e.startsWith("/storage/")?e:e.startsWith("storage/")?"/"+e:e.startsWith("http")||e.startsWith("/")?e:`/storage/${e}`:"",c=k(()=>a.images.map(e=>({...e,path:e.url||u(e.path)}))),y=e=>{console.log("Imagen de galería 2 actualizada:",e),m("images-updated",e)},v=()=>{const e=document.createElement("input");e.type="file",e.accept="image/*",e.style.display="none",e.onchange=l=>{const g=l.target.files[0];if(g){let n=1;const s=c.value.map(d=>d.name);for(;s.includes(`image_${n}`);)n++;console.log("Agregando nueva imagen:",{nextIndex:n,section:a.section}),m("images-updated",{section:a.section,imageIndex:n-1,file:g,type:"image",action:"add"})}document.body.removeChild(e)},document.body.appendChild(e),e.click()};return(e,l)=>(r(),o("div",P,[t("div",J,[t("h2",K,j(i.title||"Galería Secundaria"),1),c.value&&c.value.length>0?(r(),o("div",Q,[(r(!0),o(I,null,N(c.value,(g,n)=>(r(),o("div",{key:n,class:"h-32"},[B(W,{section:i.section,"image-index":n,"current-image":g,"is-editing":i.isEditing,onImageUpdated:y},null,8,["section","image-index","current-image","is-editing"])]))),128))])):(r(),o("div",R,l[0]||(l[0]=[t("div",{class:"text-gray-400 mb-4"},[t("svg",{class:"mx-auto h-12 w-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})])],-1),t("p",{class:"text-gray-500"},"No hay imágenes en esta galería",-1)]))),i.isEditing?(r(),o("div",X,[t("button",{onClick:v,class:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-md transition-colors duration-200 flex items-center space-x-2"},l[1]||(l[1]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),t("span",null,"Agregar imagen",-1)]))])):x("",!0)])]))}};export{ee as _,te as a};
