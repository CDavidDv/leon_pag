import{d as D,p as N,o as t,e as a,a as d,g as C,f as k,I as W,F as y,j as S,t as z,b as m,c as B,h as w}from"./app-Dsnmz9Rv.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as V}from"./EditableText-BWHGi7PF.js";const A={class:"relative w-full h-full"},q=["src","alt"],P=["src","alt"],F={key:2,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},L={class:"bg-white bg-opacity-90 p-4 rounded-lg shadow-lg"},H={class:"flex flex-col gap-2"},O={class:"text-black text-sm font-medium"},G={class:"text-black text-sm font-medium"},J={key:3,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},K={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Q={__name:"ProjectImage",props:{projectId:{type:String,required:!0},imageIndex:{type:Number,required:!0},currentImage:{type:Object,default:null},placeholderImage:{type:String,default:"/images/work/swish-fibre/1.png"},isEditing:{type:Boolean,default:!1},layout:{type:String,default:"full"}},emits:["image-updated"],setup(e,{emit:$}){const i=e,b=$,j=D(!1),o=D(!1),u=s=>s?s.startsWith("/storage/")?s:s.startsWith("storage/")?"/"+s:s.startsWith("http")||s.startsWith("/")?s:`/storage/${s}`:"",E=N(()=>i.currentImage?i.currentImage.url||u(i.currentImage.path):i.placeholderImage),U=async s=>{const c=s.target.files[0];if(c)try{j.value=!0;const f=new FormData;f.append("image",c),f.append("section",i.projectId);let v,h="add";i.currentImage&&i.currentImage.name&&i.currentImage.name.startsWith("image_")?(v=i.currentImage.name,h="replace"):(v=`image_${i.imageIndex+1}`,h="add"),console.log("Subiendo imagen:",{imageName:v,action:h,projectId:i.projectId}),f.append("name",v);const x=await S.post("/api/media/upload",f,{headers:{"Content-Type":"multipart/form-data"}});x.data.success&&(console.log("Imagen subida exitosamente:",x.data),b("image-updated",{projectId:i.projectId,imageIndex:i.imageIndex,image:{id:x.data.data.id,path:x.data.data.path,url:x.data.data.url,name:x.data.data.name,type:"image"},action:h}))}catch(f){console.error("Error al actualizar imagen:",f)}finally{j.value=!1}},n=async s=>{const c=s.target.files[0];if(c)try{j.value=!0;const f=new FormData;f.append("video",c),f.append("section",i.projectId);let v,h="add";i.currentImage&&i.currentImage.name&&i.currentImage.name.startsWith("video_")?(v=i.currentImage.name,h="replace"):(v=`video_${i.imageIndex+1}`,h="add"),console.log("Subiendo video:",{videoName:v,action:h,projectId:i.projectId}),f.append("name",v);const x=await S.post("/api/media/upload-video",f,{headers:{"Content-Type":"multipart/form-data"}});x.data.success&&(console.log("Video subido exitosamente:",x.data),b("image-updated",{projectId:i.projectId,imageIndex:i.imageIndex,video:{id:x.data.data.id,path:x.data.data.path,url:x.data.data.url,name:x.data.data.name,type:"video"},action:h}))}catch(f){console.error("Error al actualizar video:",f)}finally{j.value=!1}},g=N(()=>i.currentImage?(i.currentImage.path||i.currentImage.url||"").match(/\.(mp4|webm|ogg|mov)$/i):!1),r=()=>{o.value=!0},l=()=>{o.value=!1},I=async()=>{if(!i.currentImage||!i.currentImage.id){console.error("No hay imagen para eliminar");return}try{const s=await S.delete(`/api/media/${i.currentImage.id}`);s.data.success?(console.log("Imagen eliminada exitosamente"),b("image-updated",{projectId:i.projectId,imageIndex:i.imageIndex,action:"delete",deletedImageId:i.currentImage.id}),l()):console.error("Error al eliminar la imagen:",s.data.message)}catch(s){console.error("Error al eliminar la imagen:",s)}};return(s,c)=>(t(),a(y,null,[d("div",A,[g.value?(t(),a("video",{key:1,src:E.value,alt:`${e.projectId} - Video ${e.imageIndex+1}`,class:"w-full h-full object-cover bg-black",controls:"",autoplay:"",muted:"",loop:""},null,8,P)):(t(),a("img",{key:0,src:E.value,alt:`${e.projectId} - Imagen ${e.imageIndex+1}`,class:"w-full h-full object-cover"},null,8,q)),e.isEditing?(t(),a("div",F,[d("div",L,[d("div",H,[d("label",O,[c[0]||(c[0]=C(" Cambiar imagen: ")),d("input",{type:"file",onChange:U,accept:"image/*",class:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,32)]),d("label",G,[c[1]||(c[1]=C(" Cambiar video: ")),d("input",{type:"file",onChange:n,accept:"video/*",class:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100"},null,32)]),e.currentImage&&e.currentImage.id?(t(),a("button",{key:0,onClick:r,class:"mt-2 px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded text-sm font-medium transition-colors"},c[2]||(c[2]=[d("div",{class:"flex items-center gap-1"},[d("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[d("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})]),C(" Eliminar ")],-1)]))):k("",!0)])])])):k("",!0),j.value?(t(),a("div",J,c[3]||(c[3]=[W('<div class="bg-white p-4 rounded-lg shadow-lg flex items-center gap-2" data-v-8c1634e4><svg class="animate-spin h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" data-v-8c1634e4><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-8c1634e4></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" data-v-8c1634e4></path></svg><span class="text-black" data-v-8c1634e4>Subiendo...</span></div>',1)]))):k("",!0)]),o.value?(t(),a("div",K,[d("div",{class:"bg-white p-6 rounded-lg shadow-xl max-w-md w-full mx-4"},[d("div",{class:"text-center"},[c[4]||(c[4]=W('<div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4" data-v-8c1634e4><svg class="h-6 w-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-8c1634e4><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z" data-v-8c1634e4></path></svg></div><h3 class="text-lg font-medium text-gray-900 mb-2" data-v-8c1634e4> Confirmar eliminación </h3><p class="text-sm text-gray-500 mb-6" data-v-8c1634e4> ¿Estás seguro de que quieres eliminar esta imagen? Esta acción no se puede deshacer. </p>',3)),d("div",{class:"flex gap-3 justify-center"},[d("button",{onClick:l,class:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-md text-sm font-medium transition-colors"}," Cancelar "),d("button",{onClick:I,class:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md text-sm font-medium transition-colors"}," Eliminar ")])])])])):k("",!0)],64))}},p=T(Q,[["__scopeId","data-v-8c1634e4"]]),R={class:"flex flex-col gap-4 pl-20 pt-20"},X=["href"],Y={class:"text-white max-w-md flex flex-col gap-4 mb-20 pr-14"},Z={key:0},_={key:0,class:"w-full h-full"},ee={key:1,class:"flex lg:flex-row flex-col w-full"},te={key:2},ie={class:"w-full h-full"},ae={class:"flex lg:flex-row flex-col w-full"},le={key:3},ne={class:"flex lg:flex-row flex-col w-full"},de={class:"flex lg:flex-row flex-col w-full"},re={key:4},se={class:"flex lg:flex-row flex-col w-full"},oe={class:"flex lg:flex-row flex-col w-full"},ce={key:5},ue={key:0,class:"w-full h-96 lg:h-[500px]"},ge={key:1,class:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-4"},me={key:6,class:"flex lg:flex-row flex-col w-full flex-wrap"},fe={key:1,class:"flex lg:flex-row flex-col w-full"},xe={class:"lg:w-1/2 w-full h-full"},pe={class:"lg:w-1/2 w-full h-full"},ve={key:2,class:"flex justify-center mt-8 mb-8"},he={__name:"Proyect",props:{title:{type:String,default:"Título del proyecto"},linkText:{type:String,default:"Enlace del proyecto"},link:{type:String,default:"#"},descriptions:{type:Array,default:()=>[]},images:{type:Array,default:()=>[]},layout:{type:String,default:"2"},projectId:{type:String,required:!0},isEditing:{type:Boolean,default:!1},initialTitle:{type:String,default:""},initialDescription1:{type:String,default:""},initialDescription2:{type:String,default:""}},emits:["image-updated","text-updated"],setup(e,{emit:$}){const i=e,b=$,j=n=>n?n.startsWith("/storage/")?n:n.startsWith("storage/")?"/"+n:n.startsWith("http")||n.startsWith("/")?n:`/storage/${n}`:"",o=N(()=>i.images.map(n=>({...n,path:n.url||j(n.path)}))),u=n=>{b("image-updated",n)},E=(n,g)=>{b("text-updated",{section:i.projectId,field:n,value:g})},U=()=>{const n=document.createElement("input");n.type="file",n.accept="image/*,video/*",n.style.display="none",n.onchange=g=>{const r=g.target.files[0];if(r){const l=r.type.startsWith("video/");let I=1;const s=o.value.map(c=>c.name);if(l)for(;s.includes(`video_${I}`);)I++;else for(;s.includes(`image_${I}`);)I++;console.log("Agregando nueva imagen/video:",{type:l?"video":"image",nextIndex:I,projectId:i.projectId}),b("image-updated",{projectId:i.projectId,imageIndex:I-1,file:r,type:l?"video":"image",action:"add"})}document.body.removeChild(n)},document.body.appendChild(n),n.click()};return(n,g)=>(t(),a("div",null,[d("div",R,[d("a",{href:e.link,class:"text-white lg:text-2xl text-xl font-bold"},z(e.linkText),9,X),m(V,{"model-value":e.title,"is-editing":e.isEditing,tag:"h1",class:"text-white lg:text-7xl text-4xl font-extrabold leading-none max-w-[500px]","onUpdate:modelValue":g[0]||(g[0]=r=>E("title",r))},null,8,["model-value","is-editing"]),d("div",Y,[e.descriptions[0]?(t(),B(V,{key:0,"model-value":e.descriptions[0],"is-editing":e.isEditing,tag:"p",class:"text-white",multiline:!0,"onUpdate:modelValue":g[1]||(g[1]=r=>E("description_1",r))},null,8,["model-value","is-editing"])):k("",!0),e.descriptions[1]?(t(),B(V,{key:1,"model-value":e.descriptions[1],"is-editing":e.isEditing,tag:"p",class:"text-white",multiline:!0,"onUpdate:modelValue":g[2]||(g[2]=r=>E("description_2",r))},null,8,["model-value","is-editing"])):k("",!0)])]),o.value&&o.value.length>0?(t(),a("div",Z,[e.layout==="1"?(t(),a("div",_,[m(p,{"project-id":e.projectId,"image-index":0,"current-image":o.value[0],"is-editing":e.isEditing,onImageUpdated:u},null,8,["project-id","current-image","is-editing"])])):e.layout==="2"?(t(),a("div",ee,[(t(!0),a(y,null,w(o.value.slice(0,2),(r,l)=>(t(),a("div",{key:l,class:"lg:w-1/2 w-full h-full"},[m(p,{"project-id":e.projectId,"image-index":l,"current-image":r,"is-editing":e.isEditing,onImageUpdated:u},null,8,["project-id","image-index","current-image","is-editing"])]))),128))])):e.layout==="3"?(t(),a("div",te,[d("div",ie,[m(p,{"project-id":e.projectId,"image-index":0,"current-image":o.value[0],"is-editing":e.isEditing,onImageUpdated:u},null,8,["project-id","current-image","is-editing"])]),d("div",ae,[(t(!0),a(y,null,w(o.value.slice(1,3),(r,l)=>(t(),a("div",{key:l,class:"lg:w-1/2 w-full h-full"},[m(p,{"project-id":e.projectId,"image-index":l+1,"current-image":r,"is-editing":e.isEditing,onImageUpdated:u},null,8,["project-id","image-index","current-image","is-editing"])]))),128))])])):e.layout==="4"?(t(),a("div",le,[d("div",ne,[(t(!0),a(y,null,w(o.value.slice(0,2),(r,l)=>(t(),a("div",{key:l,class:"lg:w-1/2 w-full h-full"},[m(p,{"project-id":e.projectId,"image-index":l,"current-image":r,"is-editing":e.isEditing,onImageUpdated:u},null,8,["project-id","image-index","current-image","is-editing"])]))),128))]),d("div",de,[(t(!0),a(y,null,w(o.value.slice(2,4),(r,l)=>(t(),a("div",{key:l,class:"lg:w-1/2 w-full h-full"},[m(p,{"project-id":e.projectId,"image-index":l+2,"current-image":r,"is-editing":e.isEditing,onImageUpdated:u},null,8,["project-id","image-index","current-image","is-editing"])]))),128))])])):e.layout==="5"?(t(),a("div",re,[d("div",se,[(t(!0),a(y,null,w(o.value.slice(0,2),(r,l)=>(t(),a("div",{key:l,class:"lg:w-1/2 w-full h-full"},[m(p,{"project-id":e.projectId,"image-index":l,"current-image":r,"is-editing":e.isEditing,onImageUpdated:u},null,8,["project-id","image-index","current-image","is-editing"])]))),128))]),d("div",oe,[(t(!0),a(y,null,w(o.value.slice(2,5),(r,l)=>(t(),a("div",{key:l,class:"lg:w-1/3 w-full h-full"},[m(p,{"project-id":e.projectId,"image-index":l+2,"current-image":r,"is-editing":e.isEditing,onImageUpdated:u},null,8,["project-id","image-index","current-image","is-editing"])]))),128))])])):e.layout==="dynamic"?(t(),a("div",ce,[o.value.length===1?(t(),a("div",ue,[m(p,{"project-id":e.projectId,"image-index":0,"current-image":o.value[0],"is-editing":e.isEditing,onImageUpdated:u},null,8,["project-id","current-image","is-editing"])])):(t(),a("div",ge,[(t(!0),a(y,null,w(o.value,(r,l)=>(t(),a("div",{key:l,class:"w-full h-64 lg:h-80"},[m(p,{"project-id":e.projectId,"image-index":l,"current-image":r,"is-editing":e.isEditing,onImageUpdated:u},null,8,["project-id","image-index","current-image","is-editing"])]))),128))]))])):(t(),a("div",me,[(t(!0),a(y,null,w(o.value,(r,l)=>(t(),a("div",{key:l,class:"lg:w-1/2 w-full h-full"},[m(p,{"project-id":e.projectId,"image-index":l,"current-image":r,"is-editing":e.isEditing,onImageUpdated:u},null,8,["project-id","image-index","current-image","is-editing"])]))),128))]))])):(t(),a("div",fe,[d("div",xe,[m(p,{"project-id":e.projectId,"image-index":0,"current-image":null,"placeholder-image":"/images/work/swish-fibre/1.png","is-editing":e.isEditing,onImageUpdated:u},null,8,["project-id","is-editing"])]),d("div",pe,[m(p,{"project-id":e.projectId,"image-index":1,"current-image":null,"placeholder-image":"/images/work/swish-fibre/2.png","is-editing":e.isEditing,onImageUpdated:u},null,8,["project-id","is-editing"])])])),e.isEditing?(t(),a("div",ve,[d("button",{onClick:U,class:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-bold transition-all duration-300 flex items-center gap-2"},g[3]||(g[3]=[d("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[d("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),C(" Agregar Nueva Imagen ")]))])):k("",!0)]))}},be=T(he,[["__scopeId","data-v-c07a73f2"]]);export{be as P};
