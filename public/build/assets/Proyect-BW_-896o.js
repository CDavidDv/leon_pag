import{d as W,q as V,o as t,e as i,a as n,g as $,f as k,I as B,F as p,j as S,t as N,h as I,b as f}from"./app-CqbgnAp8.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";const q={class:"relative w-full h-full"},z=["src","alt"],A=["src","alt"],T={key:2,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},P={class:"bg-white bg-opacity-90 p-4 rounded-lg shadow-lg"},F={class:"flex flex-col gap-2"},L={class:"text-black text-sm font-medium"},H={class:"text-black text-sm font-medium"},O={key:3,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},G={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},J={__name:"ProjectImage",props:{projectId:{type:String,required:!0},imageIndex:{type:Number,required:!0},currentImage:{type:Object,default:null},placeholderImage:{type:String,default:"/images/work/swish-fibre/1.png"},isEditing:{type:Boolean,default:!1},layout:{type:String,default:"full"}},emits:["image-updated"],setup(e,{emit:U}){const a=e,b=U,w=W(!1),o=W(!1),g=s=>s?s.startsWith("/storage/")?s:s.startsWith("storage/")?"/"+s:s.startsWith("http")||s.startsWith("/")?s:`/storage/${s}`:"",E=V(()=>a.currentImage?a.currentImage.url||g(a.currentImage.path):a.placeholderImage),r=async s=>{const c=s.target.files[0];if(c)try{w.value=!0;const u=new FormData;u.append("image",c),u.append("section",a.projectId);let h,y="add";a.currentImage&&a.currentImage.name&&a.currentImage.name.startsWith("image_")?(h=a.currentImage.name,y="replace"):(h=`image_${a.imageIndex+1}`,y="add"),console.log("Subiendo imagen:",{imageName:h,action:y,projectId:a.projectId}),u.append("name",h);const m=await S.post("/api/media/upload",u,{headers:{"Content-Type":"multipart/form-data"}});m.data.success&&(console.log("Imagen subida exitosamente:",m.data),b("image-updated",{projectId:a.projectId,imageIndex:a.imageIndex,image:{id:m.data.data.id,path:m.data.data.path,url:m.data.data.url,name:m.data.data.name,type:"image"},action:y}))}catch(u){console.error("Error al actualizar imagen:",u)}finally{w.value=!1}},j=async s=>{const c=s.target.files[0];if(c)try{w.value=!0;const u=new FormData;u.append("video",c),u.append("section",a.projectId);let h,y="add";a.currentImage&&a.currentImage.name&&a.currentImage.name.startsWith("video_")?(h=a.currentImage.name,y="replace"):(h=`video_${a.imageIndex+1}`,y="add"),console.log("Subiendo video:",{videoName:h,action:y,projectId:a.projectId}),u.append("name",h);const m=await S.post("/api/media/upload-video",u,{headers:{"Content-Type":"multipart/form-data"}});m.data.success&&(console.log("Video subido exitosamente:",m.data),b("image-updated",{projectId:a.projectId,imageIndex:a.imageIndex,video:{id:m.data.data.id,path:m.data.data.path,url:m.data.data.url,name:m.data.data.name,type:"video"},action:y}))}catch(u){console.error("Error al actualizar video:",u)}finally{w.value=!1}},d=V(()=>a.currentImage?(a.currentImage.path||a.currentImage.url||"").match(/\.(mp4|webm|ogg|mov)$/i):!1),l=()=>{o.value=!0},v=()=>{o.value=!1},C=async()=>{if(!a.currentImage||!a.currentImage.id){console.error("No hay imagen para eliminar");return}try{const s=await S.delete(`/api/media/${a.currentImage.id}`);s.data.success?(console.log("Imagen eliminada exitosamente"),b("image-updated",{projectId:a.projectId,imageIndex:a.imageIndex,action:"delete",deletedImageId:a.currentImage.id}),v()):console.error("Error al eliminar la imagen:",s.data.message)}catch(s){console.error("Error al eliminar la imagen:",s)}};return(s,c)=>(t(),i(p,null,[n("div",q,[d.value?(t(),i("video",{key:1,src:E.value,alt:`${e.projectId} - Video ${e.imageIndex+1}`,class:"w-full h-full object-cover bg-black",controls:"",autoplay:"",muted:"",loop:""},null,8,A)):(t(),i("img",{key:0,src:E.value,alt:`${e.projectId} - Imagen ${e.imageIndex+1}`,class:"w-full h-full object-cover"},null,8,z)),e.isEditing?(t(),i("div",T,[n("div",P,[n("div",F,[n("label",L,[c[0]||(c[0]=$(" Cambiar imagen: ")),n("input",{type:"file",onChange:r,accept:"image/*",class:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,32)]),n("label",H,[c[1]||(c[1]=$(" Cambiar video: ")),n("input",{type:"file",onChange:j,accept:"video/*",class:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100"},null,32)]),e.currentImage&&e.currentImage.id?(t(),i("button",{key:0,onClick:l,class:"mt-2 px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded text-sm font-medium transition-colors"},c[2]||(c[2]=[n("div",{class:"flex items-center gap-1"},[n("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})]),$(" Eliminar ")],-1)]))):k("",!0)])])])):k("",!0),w.value?(t(),i("div",O,c[3]||(c[3]=[B('<div class="bg-white p-4 rounded-lg shadow-lg flex items-center gap-2" data-v-8c1634e4><svg class="animate-spin h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" data-v-8c1634e4><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-8c1634e4></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" data-v-8c1634e4></path></svg><span class="text-black" data-v-8c1634e4>Subiendo...</span></div>',1)]))):k("",!0)]),o.value?(t(),i("div",G,[n("div",{class:"bg-white p-6 rounded-lg shadow-xl max-w-md w-full mx-4"},[n("div",{class:"text-center"},[c[4]||(c[4]=B('<div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4" data-v-8c1634e4><svg class="h-6 w-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-8c1634e4><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z" data-v-8c1634e4></path></svg></div><h3 class="text-lg font-medium text-gray-900 mb-2" data-v-8c1634e4> Confirmar eliminación </h3><p class="text-sm text-gray-500 mb-6" data-v-8c1634e4> ¿Estás seguro de que quieres eliminar esta imagen? Esta acción no se puede deshacer. </p>',3)),n("div",{class:"flex gap-3 justify-center"},[n("button",{onClick:v,class:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-md text-sm font-medium transition-colors"}," Cancelar "),n("button",{onClick:C,class:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md text-sm font-medium transition-colors"}," Eliminar ")])])])])):k("",!0)],64))}},x=D(J,[["__scopeId","data-v-8c1634e4"]]),K={class:"flex flex-col gap-4 pl-20 pt-20"},Q=["href"],R={class:"text-white lg:text-7xl text-4xl font-extrabold leading-none max-w-[500px]"},X={class:"text-white max-w-md flex flex-col gap-4 mb-20 pr-14"},Y={key:0},Z={key:0,class:"w-full h-full"},_={key:1,class:"flex lg:flex-row flex-col w-full"},ee={key:2},te={class:"w-full h-full"},ie={class:"flex lg:flex-row flex-col w-full"},ae={key:3},le={class:"flex lg:flex-row flex-col w-full"},ne={class:"flex lg:flex-row flex-col w-full"},re={key:4},de={class:"flex lg:flex-row flex-col w-full"},se={class:"flex lg:flex-row flex-col w-full"},oe={key:5},ce={key:0,class:"w-full h-96 lg:h-[500px]"},ge={key:1,class:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-4"},ue={key:6,class:"flex lg:flex-row flex-col w-full flex-wrap"},me={key:1,class:"flex lg:flex-row flex-col w-full"},fe={class:"lg:w-1/2 w-full h-full"},xe={class:"lg:w-1/2 w-full h-full"},pe={key:2,class:"flex justify-center mt-8 mb-8"},ve={__name:"Proyect",props:{title:{type:String,default:"Título del proyecto"},linkText:{type:String,default:"Enlace del proyecto"},link:{type:String,default:"#"},descriptions:{type:Array,default:()=>[]},images:{type:Array,default:()=>[]},layout:{type:String,default:"2"},projectId:{type:String,required:!0},isEditing:{type:Boolean,default:!1}},emits:["image-updated"],setup(e,{emit:U}){const a=e,b=U,w=r=>r?r.startsWith("/storage/")?r:r.startsWith("storage/")?"/"+r:r.startsWith("http")||r.startsWith("/")?r:`/storage/${r}`:"",o=V(()=>a.images.map(r=>({...r,path:r.url||w(r.path)}))),g=r=>{b("image-updated",r)},E=()=>{const r=document.createElement("input");r.type="file",r.accept="image/*,video/*",r.style.display="none",r.onchange=j=>{const d=j.target.files[0];if(d){const l=d.type.startsWith("video/");let v=1;const C=o.value.map(s=>s.name);if(l)for(;C.includes(`video_${v}`);)v++;else for(;C.includes(`image_${v}`);)v++;console.log("Agregando nueva imagen/video:",{type:l?"video":"image",nextIndex:v,projectId:a.projectId}),b("image-updated",{projectId:a.projectId,imageIndex:v-1,file:d,type:l?"video":"image",action:"add"})}document.body.removeChild(r)},document.body.appendChild(r),r.click()};return(r,j)=>(t(),i("div",null,[n("div",K,[n("a",{href:e.link,class:"text-white lg:text-2xl text-xl font-bold"},N(e.linkText),9,Q),n("h1",R,N(e.title),1),n("div",X,[(t(!0),i(p,null,I(e.descriptions,(d,l)=>(t(),i("p",{key:l},N(d),1))),128))])]),o.value&&o.value.length>0?(t(),i("div",Y,[e.layout==="1"?(t(),i("div",Z,[f(x,{"project-id":e.projectId,"image-index":0,"current-image":o.value[0],"is-editing":e.isEditing,onImageUpdated:g},null,8,["project-id","current-image","is-editing"])])):e.layout==="2"?(t(),i("div",_,[(t(!0),i(p,null,I(o.value.slice(0,2),(d,l)=>(t(),i("div",{key:l,class:"lg:w-1/2 w-full h-full"},[f(x,{"project-id":e.projectId,"image-index":l,"current-image":d,"is-editing":e.isEditing,onImageUpdated:g},null,8,["project-id","image-index","current-image","is-editing"])]))),128))])):e.layout==="3"?(t(),i("div",ee,[n("div",te,[f(x,{"project-id":e.projectId,"image-index":0,"current-image":o.value[0],"is-editing":e.isEditing,onImageUpdated:g},null,8,["project-id","current-image","is-editing"])]),n("div",ie,[(t(!0),i(p,null,I(o.value.slice(1,3),(d,l)=>(t(),i("div",{key:l,class:"lg:w-1/2 w-full h-full"},[f(x,{"project-id":e.projectId,"image-index":l+1,"current-image":d,"is-editing":e.isEditing,onImageUpdated:g},null,8,["project-id","image-index","current-image","is-editing"])]))),128))])])):e.layout==="4"?(t(),i("div",ae,[n("div",le,[(t(!0),i(p,null,I(o.value.slice(0,2),(d,l)=>(t(),i("div",{key:l,class:"lg:w-1/2 w-full h-full"},[f(x,{"project-id":e.projectId,"image-index":l,"current-image":d,"is-editing":e.isEditing,onImageUpdated:g},null,8,["project-id","image-index","current-image","is-editing"])]))),128))]),n("div",ne,[(t(!0),i(p,null,I(o.value.slice(2,4),(d,l)=>(t(),i("div",{key:l,class:"lg:w-1/2 w-full h-full"},[f(x,{"project-id":e.projectId,"image-index":l+2,"current-image":d,"is-editing":e.isEditing,onImageUpdated:g},null,8,["project-id","image-index","current-image","is-editing"])]))),128))])])):e.layout==="5"?(t(),i("div",re,[n("div",de,[(t(!0),i(p,null,I(o.value.slice(0,2),(d,l)=>(t(),i("div",{key:l,class:"lg:w-1/2 w-full h-full"},[f(x,{"project-id":e.projectId,"image-index":l,"current-image":d,"is-editing":e.isEditing,onImageUpdated:g},null,8,["project-id","image-index","current-image","is-editing"])]))),128))]),n("div",se,[(t(!0),i(p,null,I(o.value.slice(2,5),(d,l)=>(t(),i("div",{key:l,class:"lg:w-1/3 w-full h-full"},[f(x,{"project-id":e.projectId,"image-index":l+2,"current-image":d,"is-editing":e.isEditing,onImageUpdated:g},null,8,["project-id","image-index","current-image","is-editing"])]))),128))])])):e.layout==="dynamic"?(t(),i("div",oe,[o.value.length===1?(t(),i("div",ce,[f(x,{"project-id":e.projectId,"image-index":0,"current-image":o.value[0],"is-editing":e.isEditing,onImageUpdated:g},null,8,["project-id","current-image","is-editing"])])):(t(),i("div",ge,[(t(!0),i(p,null,I(o.value,(d,l)=>(t(),i("div",{key:l,class:"w-full h-64 lg:h-80"},[f(x,{"project-id":e.projectId,"image-index":l,"current-image":d,"is-editing":e.isEditing,onImageUpdated:g},null,8,["project-id","image-index","current-image","is-editing"])]))),128))]))])):(t(),i("div",ue,[(t(!0),i(p,null,I(o.value,(d,l)=>(t(),i("div",{key:l,class:"lg:w-1/2 w-full h-full"},[f(x,{"project-id":e.projectId,"image-index":l,"current-image":d,"is-editing":e.isEditing,onImageUpdated:g},null,8,["project-id","image-index","current-image","is-editing"])]))),128))]))])):(t(),i("div",me,[n("div",fe,[f(x,{"project-id":e.projectId,"image-index":0,"current-image":null,"placeholder-image":"/images/work/swish-fibre/1.png","is-editing":e.isEditing,onImageUpdated:g},null,8,["project-id","is-editing"])]),n("div",xe,[f(x,{"project-id":e.projectId,"image-index":1,"current-image":null,"placeholder-image":"/images/work/swish-fibre/2.png","is-editing":e.isEditing,onImageUpdated:g},null,8,["project-id","is-editing"])])])),e.isEditing?(t(),i("div",pe,[n("button",{onClick:E,class:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-bold transition-all duration-300 flex items-center gap-2"},j[0]||(j[0]=[n("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),$(" Agregar Nueva Imagen ")]))])):k("",!0)]))}},Ie=D(ve,[["__scopeId","data-v-8356616f"]]);export{Ie as P};
