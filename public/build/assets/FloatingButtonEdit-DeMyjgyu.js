import{d as v,p as S,o as l,e as i,a as n,n as y,t as b,f,j as E,b as j}from"./app-Dsnmz9Rv.js";const z={class:"flex flex-col items-center space-y-4"},W={class:"relative"},U=["src","alt"],$={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center rounded"},N=["disabled"],T=["disabled"],F={key:1,class:"mt-4"},V=["src"],A={class:"mt-2 space-x-2"},D=["disabled"],q=["disabled"],L={__name:"ImageUploader",props:{currentImage:{type:String,default:""},section:{type:String,required:!0},name:{type:String,required:!0},alt:{type:String,default:"Imagen"},imageClass:{type:String,default:"w-32 h-32 object-contain"},previewClass:{type:String,default:"w-24 h-24 object-cover border-2 border-blue-300 rounded"},buttonText:{type:String,default:"Seleccionar imagen"},showEditButton:{type:Boolean,default:!1},maxSize:{type:Number,default:5}},emits:["imageUpdated"],setup(r,{emit:p}){const t=r,d=v(null),u=v(null),c=v(null),e=v(!1),o=v(""),x=v(""),I=S(()=>t.currentImage?t.currentImage.startsWith("/storage/")?t.currentImage:t.currentImage.startsWith("storage/")?"/"+t.currentImage:t.currentImage.startsWith("http")||t.currentImage.startsWith("/")?t.currentImage:`/storage/${t.currentImage}`:"/images/placeholder.svg"),w=()=>{d.value.click()},C=g=>{const a=g.target.files[0];if(console.log("Archivo seleccionado:",a),a){if(!a.type.startsWith("image/")){m("Por favor selecciona un archivo de imagen válido","error");return}if(a.size>t.maxSize*1024*1024){m(`La imagen debe ser menor a ${t.maxSize}MB`,"error");return}c.value=a,console.log("Archivo guardado en archivoSeleccionado:",c.value);const s=new FileReader;s.onload=h=>{u.value=h.target.result,console.log("Nueva imagen establecida:",u.value)},s.readAsDataURL(a)}},k=async()=>{var g,a;if(!c.value){m("No hay archivo seleccionado","error");return}e.value=!0,o.value="";try{const s=new FormData;s.append("image",c.value),s.append("section",t.section),s.append("name",t.name);const h=await E.post("/api/media/upload",s,{headers:{"Content-Type":"multipart/form-data"}});h.data.success?(u.value=null,c.value=null,d.value.value="",m("Imagen actualizada exitosamente","success"),B("imageUpdated",h.data.data)):m(h.data.message||"Error al subir la imagen","error")}catch(s){console.error("Error al subir la imagen:",s),m(((a=(g=s.response)==null?void 0:g.data)==null?void 0:a.message)||"Error al subir la imagen. Inténtalo de nuevo.","error")}finally{e.value=!1}},_=()=>{u.value=null,c.value=null,d.value.value="",o.value=""},m=(g,a)=>{o.value=g,x.value=a,setTimeout(()=>{o.value=""},5e3)},B=p;return(g,a)=>(l(),i("div",z,[n("div",W,[n("img",{src:I.value,alt:r.alt,class:y(r.imageClass)},null,10,U),r.showEditButton?(l(),i("div",$,[n("button",{class:"bg-white text-gray-800 px-3 py-1 rounded text-sm font-medium",onClick:w,disabled:e.value},b(e.value?"Subiendo...":"Editar"),9,N)])):f("",!0)]),r.showEditButton?f("",!0):(l(),i("button",{key:0,class:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-md transition-colors duration-200",onClick:w,disabled:e.value},b(e.value?"Subiendo...":r.buttonText),9,T)),n("input",{type:"file",ref_key:"fileInput",ref:d,onChange:C,accept:"image/*",class:"hidden"},null,544),u.value?(l(),i("div",F,[a[0]||(a[0]=n("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Vista previa:",-1)),n("img",{src:u.value,alt:"Vista previa",class:y(r.previewClass)},null,10,V),n("div",A,[n("button",{onClick:k,disabled:e.value,class:"bg-green-500 hover:bg-green-600 disabled:bg-gray-400 text-white px-3 py-1 rounded text-sm"},b(e.value?"Subiendo...":"Confirmar"),9,D),n("button",{onClick:_,disabled:e.value,class:"bg-red-500 hover:bg-red-600 disabled:bg-gray-400 text-white px-3 py-1 rounded text-sm"}," Cancelar ",8,q)])])):f("",!0),o.value?(l(),i("div",{key:2,class:y(["mt-2 p-2 rounded text-sm",x.value==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},b(o.value),3)):f("",!0)]))}},M={class:"fixed bottom-0 right-14"},R=["src"],O={key:1,xmlns:"http://www.w3.org/2000/svg",class:"size-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},P={key:2,class:"absolute bottom-full right-0 z-10 bg-white p-2 rounded-lg shadow-lg border mb-2"},H={__name:"FloatingButtonEdit",props:{isEditing:{type:Boolean,default:!1},floatingButtonImage:{type:Object,default:null}},emits:["image-updated"],setup(r,{emit:p}){const t=p,d=e=>!e||!e.path?null:e.path.startsWith("/storage/")?e.path:e.path.startsWith("storage/")?"/"+e.path:e.path.startsWith("http")||e.path.startsWith("/")?e.path:`/storage/${e.path}`,u=e=>{console.log("Imagen actualizada en FloatingButtonEdit:",e),t("image-updated",e)},c=()=>{console.log("showBarContact from floating button")};return(e,o)=>(l(),i("div",M,[n("div",{class:"size-60 bg-white rounded-full flex justify-center items-center cursor-pointer relative",onClick:c},[r.floatingButtonImage?(l(),i("img",{key:0,src:d(r.floatingButtonImage),alt:"Botón flotante",class:"w-full h-full object-cover rounded-full"},null,8,R)):(l(),i("svg",O,o[0]||(o[0]=[n("line",{x1:"18",y1:"6",x2:"6",y2:"18"},null,-1),n("line",{x1:"6",y1:"6",x2:"18",y2:"18"},null,-1)]))),r.isEditing?(l(),i("div",P,[o[1]||(o[1]=n("div",{class:"text-xs text-gray-600 mb-2"},"Editar imagen",-1)),j(L,{currentImage:d(r.floatingButtonImage),section:"welcome",name:"floating_button",alt:"Imagen del botón flotante",imageClass:"w-16 h-16 object-cover rounded-lg",previewClass:"w-32 h-32 object-cover border-2 border-blue-300 rounded-full",buttonText:"Cambiar imagen",showEditButton:!1,maxSize:5,onImageUpdated:u},null,8,["currentImage"])])):f("",!0)])]))}};export{H as _,L as a};
